// com.app.model.TestDataModel// Adam Riggs//package com.app.model{	import com.adam.events.MuleEvent;	import com.adam.utils.AppData;		import flash.display.Sprite;	import flash.events.*;	import flash.utils.Timer;	import flash.net.URLVariables;		public class TestDataModel {						//objects		private var appData:AppData=AppData.instance;		private var dataTimer:Timer;				//vars		private var _urlVars:URLVariables;		private var _xml:XML;		private var _obj:Object;		private var _dataInterval:Number;				//const		public const NAME:String="testDataModel";		public const RETURNTYPE:String=NAME;				//instance		private static const _instance:TestDataModel = new TestDataModel(TestDataModelLock);				public function TestDataModel(lock:Class){			// Verify that the lock is the correct class reference.			if (lock != TestDataModelLock)			{				throw new Error("Invalid TestDataModel access.  Use TestDataModel.instance instead.");			} else {				init();			}		}		//*****Initialization Routines				public function init():void{			//this.visible = false;			debug("init()");						initVars();			initEvents();			initURLVariables();			initTimer();		}				private function initVars():void{			//local instances of other vars			_dataInterval=appData.model.dataTimerInterval;						//local vars			_xml=new XML();			_obj=new Object();		}				private function initEvents():void{			appData.eventManager.listen(NAME, onTestDataModel);			appData.eventManager.listen("sql", onSQL);		}				private function initURLVariables():void{			_urlVars=new URLVariables();					}				private function initTimer():void{			dataTimer=new Timer(_dataInterval);			dataTimer.addEventListener(TimerEvent.TIMER,onDataTimer);		}		//*****Core Functionality				public function startData():void{			//dataTimer.start();		}				public function stopData():void{			dataTimer.stop();			dataTimer.reset();		}				private function processData(rawData:String):void{			_xml=new XML(rawData);			_obj=new Object();					}		//*****Event Handlers				private function onDataTimer(e:TimerEvent):void{			appData.eventManager.dispatch("sqlProxy", {type:"selectSQL", sender:NAME, vars:_urlVars, returnType:RETURNTYPE});		}				private function onSQL(e:MuleEvent):void{			/*debug("onSQL()");			debug("e.data.sender=="+e.data.sender);			debug("e.data.type=="+e.data.type);*/			switch(e.data.type){								case RETURNTYPE:					try{						processData(e.data.result);					}catch(err:Error){						debug("error processing sql result data");						debug(e.data.result);					}				break;							}		}				private function onTestDataModel(e:MuleEvent):void{			/*debug("onTestDataModel()");			debug("e.data.sender=="+e.data.sender);			debug("e.data.type=="+e.data.type);*/			switch(e.data.type){															}		}				//*****Gets and Sets				public static function get instance():TestDataModel{return _instance;}				public function get xml():XML{return _xml;}		public function get obj():Object{return _obj;}		//*****Utility Functions						//**debug		private function debug(str:String):void{			/*trace("TestDataModel:"+str);			appData.eventManager.dispatch("debug", {msg:str, sender:"TestDataModel"});*/			appData.debug(NAME,str);		}				}//end class}//end packageclass TestDataModelLock{}